generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  user_id        Int       @id @default(autoincrement())
  email          String    @unique
  password_hash  String
  phone_number   String?   @db.VarChar(20)
  first_name     String?   @db.VarChar(50)
  last_name      String?   @db.VarChar(50)
  profile_picture String?  @db.VarChar(255)
  created_at     DateTime  @default(now())
  orders         Order[]
  orderHistory   OrderHistory[]

  @@map("Users")
}

model MenuItem {
  item_id     Int      @id @default(autoincrement())
  name        String   @db.VarChar(255)
  description String?  @db.Text
  price       Decimal  @db.Decimal(10, 2)
  image_url   String?  @db.VarChar(255)
  is_available Boolean @default(true)
  orderItems  OrderItem[]

  @@map("MenuItems")
}

model Order {
  order_id    Int       @id @default(autoincrement())
  user_id     Int
  order_status String   @db.VarChar(50)
  total_price Decimal  @db.Decimal(10, 2)
  created_at  DateTime  @default(now())
  user        User      @relation(fields: [user_id], references: [user_id])
  orderItems  OrderItem[]
  orderHistory OrderHistory[]

  @@map("Orders")
}

model OrderItem {
  order_item_id Int      @id @default(autoincrement())
  order_id      Int
  item_id       Int
  quantity      Int
  customizations String? @db.Text
  price         Decimal  @db.Decimal(10, 2)
  order         Order    @relation(fields: [order_id], references: [order_id])
  menuItem      MenuItem @relation(fields: [item_id], references: [item_id])

  @@map("OrderItems")
}

model OrderHistory {
  history_id Int      @id @default(autoincrement())
  user_id    Int
  order_id   Int
  created_at DateTime @default(now())
  user       User     @relation(fields: [user_id], references: [user_id])
  order      Order    @relation(fields: [order_id], references: [order_id])

  @@map("OrderHistory")
}
